Port 22
ListenAddress 0.0.0.0
Protocol 2
HostKey /etc/ssh/ssh_host_rsa_key
HostKey /etc/ssh/ssh_host_dsa_key
HostKey /etc/ssh/ssh_host_ecdsa_key
HostKey /etc/ssh/ssh_host_ed25519_key
AcceptEnv LANG LC_*
AuthorizedKeysFile %h/.ssh/authorized_keys
AuthorizedPrincipalsFile /etc/ssh/auth_principals/%u
ChallengeResponseAuthentication no
HostbasedAuthentication no
LogLevel INFO
LoginGraceTime 120
IgnoreRhosts yes
PermitEmptyPasswords no
PermitRootLogin without-password
PrintLastLog yes
PrintMotd no
PubkeyAuthentication yes
StrictModes yes
Subsystem sftp /usr/lib/openssh/sftp-server
SyslogFacility AUTH
TCPKeepAlive yes
TrustedUserCAKeys {{ ca_key_path }}.pub
UseDNS no
UsePAM yes
X11DisplayOffset 10
PasswordAuthentication no

Match User ubuntu
  PasswordAuthentication yes

Match Group admin
  AllowAgentForwarding yes
  AllowTcpForwarding yes
  GatewayPorts yes
  X11Forwarding yes
  PermitTunnel yes
  PasswordAuthentication yes

Match Group proxy
  AllowAgentForwarding yes
  AllowTcpForwarding yes
  GatewayPorts yes
  X11Forwarding yes
  PermitTunnel yes
  ForceCommand none
  PubkeyAuthentication yes
  
Match Group sftp
  ForceCommand internal-sftp

